// DOMAIN: User Preference
// COMPLIANCE: GDPR Article 7 (Consent), SOC 2 CC6.1
// SECURITY: Non-PII configuration data
// PII: No - preferences and settings are not personal identifiers

syntax = "proto3";

package geniustechspace.preference.user.v1;

import "buf/validate/validate.proto";
import "google/protobuf/timestamp.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Preference.User.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/preference/user/v1;preferenceuserv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.preference.user.v1";

// UserPreferences - user preferences and settings.
// Non-PII: Configuration data, not personal identifiers.
// ONE-TO-ONE: Each user has one preferences record.
// USAGE: UI customization, localization, notifications, privacy, accessibility.
message UserPreferences {
  // Preferences ID. Primary key.
  string preferences_id = 1 [(buf.validate.field).string.max_len = 512];

  // User ID. Foreign key to identity system (one-to-one relationship).
  string user_id = 2 [(buf.validate.field).string.max_len = 512];

  // Hierarchical tenant path for nested multi-tenancy.
  // Examples: "acme-corp", "acme-corp/customer-1", "acme-corp/customer-1/sub-org"
  // ISOLATION: Supports unlimited nesting levels for complex B2B2B... scenarios.
  string tenant_path = 3 [(buf.validate.field).string.max_len = 512];

  // Preferred language (ISO 639-1 code: en, es, fr, etc.).
  // COMPLIANCE: GDPR Article 7 - user consent for communication language.
  string preferred_language = 4 [(buf.validate.field).string.pattern = "^[a-z]{2}$"];

  // Timezone (IANA timezone: America/New_York, Europe/London, etc.).
  string timezone = 5 [(buf.validate.field).string.max_len = 512];

  // Locale (BCP 47 language tag: en-US, fr-FR, etc.).
  string locale = 6 [(buf.validate.field).string.pattern = "^[a-z]{2}(-[A-Z]{2})?$"];

  // Date format preference (YYYY-MM-DD, MM/DD/YYYY, DD/MM/YYYY, etc.).
  string date_format = 7 [(buf.validate.field).string.max_len = 50];

  // Time format preference (24h, 12h).
  string time_format = 8 [(buf.validate.field).string.max_len = 10];

  // Currency preference (ISO 4217 code: USD, EUR, GBP, etc.).
  string currency = 9 [(buf.validate.field).string = {
    len: 3
    pattern: "^[A-Z]{3}$"
  }];

  reserved 10 to 19;

  // Notification preferences.
  // COMPLIANCE: GDPR Article 7, CAN-SPAM Act, CCPA consent.
  NotificationPreferences notifications = 20;

  // Privacy preferences.
  // COMPLIANCE: GDPR Article 7, CCPA privacy settings.
  PrivacyPreferences privacy = 21;

  // Accessibility preferences.
  // COMPLIANCE: WCAG 2.1, ADA, Section 508 accessibility requirements.
  AccessibilityPreferences accessibility = 22;

  reserved 23 to 29;

  // Created timestamp.
  google.protobuf.Timestamp created_at = 30 [(buf.validate.field).required = true];

  // Last updated timestamp.
  google.protobuf.Timestamp updated_at = 31;

  reserved 32 to 39;
}

// NotificationPreferences - notification channel preferences.
// COMPLIANCE: GDPR Article 7 (consent), CAN-SPAM Act, CCPA.
message NotificationPreferences {
  // Email notifications enabled.
  // COMPLIANCE: Requires explicit consent under GDPR/CAN-SPAM.
  bool email_enabled = 1;

  // SMS notifications enabled.
  // COMPLIANCE: Requires explicit consent under TCPA/GDPR.
  bool sms_enabled = 2;

  // Push notifications enabled.
  bool push_enabled = 3;

  // In-app notifications enabled.
  bool in_app_enabled = 4;

  // Notification frequency (realtime, daily_digest, weekly_digest).
  // VALIDATION: Must be one of the predefined values
  string frequency = 5 [(buf.validate.field).string = {
    in: [
      "realtime",
      "daily_digest",
      "weekly_digest",
      "none"
    ]
  }];

  // Quiet hours start (HH:MM format, 24-hour time).
  // Example: "22:00" for 10 PM
  string quiet_hours_start = 6 [(buf.validate.field).string = {pattern: "^([01]?[0-9]|2[0-3]):[0-5][0-9]$"}];

  // Quiet hours end (HH:MM format, 24-hour time).
  // Example: "08:00" for 8 AM
  string quiet_hours_end = 7 [(buf.validate.field).string = {pattern: "^([01]?[0-9]|2[0-3]):[0-5][0-9]$"}];
}

// PrivacyPreferences - privacy and visibility preferences.
// COMPLIANCE: GDPR Article 7 (consent), CCPA privacy rights.
message PrivacyPreferences {
  // Profile visibility (public, private, connections_only).
  // COMPLIANCE: GDPR Article 6 - lawful basis for data processing.
  string profile_visibility = 1 [(buf.validate.field).string = {
    in: [
      "public",
      "private",
      "connections_only",
      "organization_only"
    ]
  }];

  // Search engine indexing allowed.
  // COMPLIANCE: GDPR Article 17 - right to be forgotten.
  bool searchable = 2;

  // Show online status.
  bool show_online_status = 3;

  // Show last activity.
  bool show_last_activity = 4;

  // Allow contact from non-connections.
  bool allow_contact = 5;
}

// AccessibilityPreferences - accessibility UI adaptations.
// COMPLIANCE: WCAG 2.1, ADA, Section 508, European Accessibility Act.
message AccessibilityPreferences {
  // High contrast mode.
  // COMPLIANCE: WCAG 2.1 Level AA - 1.4.3 Contrast (Minimum).
  bool high_contrast = 1;

  // Reduced motion.
  // COMPLIANCE: WCAG 2.1 Level AAA - 2.3.3 Animation from Interactions.
  bool reduced_motion = 2;

  // Screen reader optimized.
  // COMPLIANCE: WCAG 2.1 Level A - 1.3.1 Info and Relationships.
  bool screen_reader = 3;

  // Font size multiplier (1.0 = default, 1.5 = 150%, etc.).
  // COMPLIANCE: WCAG 2.1 Level AA - 1.4.4 Resize text.
  // VALIDATION: Must be between 0.5 (50%) and 3.0 (300%)
  float font_size_multiplier = 4 [(buf.validate.field).float = {
    gte: 0.5
    lte: 3.0
  }];

  // Keyboard navigation only.
  // COMPLIANCE: WCAG 2.1 Level A - 2.1.1 Keyboard.
  bool keyboard_navigation = 5;
}
