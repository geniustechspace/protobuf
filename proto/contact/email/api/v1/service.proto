// Email Management gRPC Service
//
// Provides gRPC API for email address lifecycle management including CRUD operations,
// verification workflows, and primary email management.
//
// DOMAIN: Contact - Email Management
// VERSION: v1
// COMPLIANCE: SOC 2 CC6.1, GDPR Articles 5/15-17, ISO 27001 A.9.2
// PII: Yes - Contains personal identifiers and email data

syntax = "proto3";

package geniustechspace.contact.email.api.v1;

import "contact/email/api/v1/request.proto";
import "contact/email/api/v1/response.proto";

option go_package = "github.com/geniustechspace/protobuf/gen/go/contact/email/api/v1;emailv1";
option java_multiple_files = true;
option java_outer_classname = "EmailServiceProto";
option java_package = "com.geniustechspace.protobuf.contact.email.api.v1";

// EmailService manages email address lifecycle operations.
//
// All RPCs require authentication (Bearer token) and authorization (RBAC permissions).
// Mutations publish domain events. Rate limits enforced per-tenant.
service EmailService {
  // CreateEmail creates a new email address.
  // AUTH: Requires 'contact:email:create' permission OR self-access
  // EVENTS: Publishes EmailCreated
  // RATE LIMIT: 20/min per tenant
  rpc CreateEmail(CreateEmailRequest) returns (EmailResponse);

  // GetEmail retrieves email by ID.
  // AUTH: Requires 'contact:email:read' permission OR self-access
  // RATE LIMIT: 100/min per tenant
  rpc GetEmail(GetEmailRequest) returns (EmailResponse);

  // UpdateEmail modifies existing email (partial update).
  // AUTH: Requires 'contact:email:update' permission OR self-access
  // NOTE: Uses optimistic locking via version field
  // EVENTS: Publishes EmailUpdated
  // RATE LIMIT: 50/min per tenant
  rpc UpdateEmail(UpdateEmailRequest) returns (EmailResponse);

  // DeleteEmail soft-deletes or hard-deletes email.
  // AUTH: Requires 'contact:email:delete' permission OR self-access (soft)
  //       or 'contact:email:hard_delete' (hard)
  // NOTE: Hard delete is irreversible
  // EVENTS: Publishes EmailDeleted
  // RATE LIMIT: 20/min per tenant
  rpc DeleteEmail(DeleteEmailRequest) returns (DeleteEmailResponse);

  // ListEmails retrieves paginated list of emails for a user.
  // AUTH: Requires 'contact:email:list' permission OR self-access
  // NOTE: Ordered by created_at DESC, max 100 items per page
  // RATE LIMIT: 50/min per tenant
  rpc ListEmails(ListEmailsRequest) returns (ListEmailsResponse);

  // VerifyEmail verifies email with verification token.
  // AUTH: Requires verification token (expires 24h) OR 'contact:email:verify' permission
  // EVENTS: Publishes EmailVerified
  // RATE LIMIT: 10/min per email
  rpc VerifyEmail(VerifyEmailRequest) returns (VerifyEmailResponse);

  // SendVerificationEmail sends verification email.
  // AUTH: Requires 'contact:email:send_verification' permission OR self-access
  // RATE LIMIT: 3/hour per email (anti-spam)
  rpc SendVerificationEmail(SendVerificationEmailRequest) returns (SendVerificationEmailResponse);
}
