// DOMAIN: Contact - Phone Numbers
// COMPLIANCE: GDPR Article 5, SOC 2 CC6.1
// SECURITY: PII data - encryption at rest required
// PII: Yes - phone number is personal identifier

syntax = "proto3";

package geniustechspace.contact.phone.v1;

import "buf/validate/validate.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.com/geniustechspace/protobuf/gen/go/contact/phone/v1;contactphonev1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.contact.phone.v1";

// PhoneNumberLabel - standard phone number classifications.
enum PhoneNumberLabel {
  UNSPECIFIED = 0; // Default value, not set
  MOBILE = 1; // Mobile/cell phone (SMS-capable, portable)
  HOME = 2; // Home/residential landline
  WORK = 3; // Work/business phone
  FAX = 4; // Fax number (document transmission)
  PAGER = 5; // Pager/beeper
  CUSTOM = 6; // Custom label (use custom_label field)
}

// PhoneNumber - user's phone numbers.
// PII: Yes - GDPR Article 4(1) personal identifier.
// MULTI-RECORD: Users can have multiple phone numbers (mobile, home, work, fax).
// USAGE: Contact, 2FA/MFA, SMS notifications, voice calls, verification.
message PhoneNumber {
  // Phone number ID. Primary key.
  string phone_id = 1 [(buf.validate.field).string.max_len = 512];

  // User ID. Foreign key to identity system.
  string owner_id = 2 [(buf.validate.field).string.max_len = 512];

  // Phone number classification label.
  // USAGE: Determines communication context and routing behavior.
  PhoneNumberLabel label = 4 [(buf.validate.field).enum.defined_only = true];

  // Phone number in E.164 format (+1234567890).
  // VALIDATION: Must start with + followed by country code and number.
  string number = 5 [(buf.validate.field).string.pattern = "^\\+[1-9]\\d{1,14}$"];

  // Country code (extracted from E.164).
  string country_code = 6 [(buf.validate.field).string.max_len = 5];

  // Extension (for business phones).
  string extension = 7 [(buf.validate.field).string.max_len = 10];

  // Custom label text. REQUIRED when label = CUSTOM.
  // Examples: "Mom's iPhone", "Beach House", "Emergency Contact"
  string custom_label = 8 [(buf.validate.field).string.max_len = 100];

  // Optional tags for additional categorization and metadata.
  // Examples: ["emergency", "primary-contact", "sms-enabled", "voicemail", "do-not-disturb"]
  // VALIDATION: Lowercase alphanumeric with hyphens only.
  repeated string tags = 9 [(buf.validate.field).repeated = {
    max_items: 20
    items: {
      string: {
        min_len: 1
        max_len: 50
        pattern: "^[a-z0-9-]+$"
      }
    }
  }];

  // Primary phone flag (one primary per type per user).
  bool is_primary = 10;

  reserved 11 to 19;

  // Verification timestamp.
  google.protobuf.Timestamp verified_at = 20;

  // Created timestamp.
  google.protobuf.Timestamp created_at = 21 [(buf.validate.field).required = true];

  // Last updated timestamp.
  google.protobuf.Timestamp updated_at = 22;

  // Deletion timestamp (soft delete).
  google.protobuf.Timestamp deleted_at = 23;

  reserved 24 to 29;

  // Optimistic locking version.
  int64 version = 30 [(buf.validate.field).int64.gte = 1];

  reserved 31 to 39;
}
