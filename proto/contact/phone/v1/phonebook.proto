// DOMAIN: Contact - User Phonebook
// COMPLIANCE: GDPR Article 5
// SECURITY: Contains references to PII, no raw number stored

syntax = "proto3";

package geniustechspace.contact.phone.v1;

import "buf/validate/validate.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.com/geniustechspace/protobuf/gen/go/contact/phone/v1;contactphonev1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.contact.phone.v1";

// UserContactPhone represents a user saving a phone number.
message UserContactPhone {
  // Contact entry ID (PK)
  string contact_id = 1 [(buf.validate.field).string.max_len = 512];

  // User who saved the contact
  string user_id = 2 [(buf.validate.field).string.max_len = 512];

  // Referenced phone number
  string phone_id = 3 [(buf.validate.field).string.max_len = 512];

  // User-defined display name
  string display_name = 4 [(buf.validate.field).string.max_len = 150];

  // Optional notes (user-specific)
  string notes = 5 [(buf.validate.field).string.max_len = 500];

  // User-specific tags
  repeated string tags = 6 [(buf.validate.field).repeated = {
    max_items: 20
    items: {
      string: {
        min_len: 1
        max_len: 50
        pattern: "^[a-z0-9-]+$"
      }
    }
  }];

  // Audit fields
  google.protobuf.Timestamp created_at = 20 [(buf.validate.field).required = true];
  google.protobuf.Timestamp updated_at = 21;
  google.protobuf.Timestamp deleted_at = 22;

  // Optimistic locking
  int64 version = 30 [(buf.validate.field).int64.gte = 1];
}
