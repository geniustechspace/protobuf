// Session Messages - Production v1
//
// Enterprise-grade session management for users, clients, and AI agents.
// Multitenant aware. Follows GeniusTechSpace design patterns.

syntax = "proto3";

package geniustechspace.datastructure.v1.session;

import "google/protobuf/timestamp.proto";
import "proto/datastructure/v1/session/enums.proto";

option go_package = "github.com/geniustechspace/protobuf/gen/go/datastructure/v1/session;sessionv1";
option java_multiple_files = true;
option java_package = "space.geniustech.datastructure.v1.session";
option csharp_namespace = "GeniusTechSpace.Datastructure.V1.Session";

// Session: Core session data structure for multitenant environments
message Session {
  reserved 5 to 10, 17 to 20, 25 to 30, 35 to 40;
	// Unique session identifier
	string session_id = 1 [(buf.validate.field).string = { min_len: 8, max_len: 128 }];

	// User/client/agent identifiers
  oneof actor {
    string user = 2 [(buf.validate.field).string = { max_len: 128, ignore_empty: true }];
    string client = 3 [(buf.validate.field).string = { max_len: 128, ignore_empty: true }];
    string agent = 4 [(buf.validate.field).string = { max_len: 128, ignore_empty: true }];
  }

	// Tenant context
	string tenant_id = 11 [(buf.validate.field).string = { min_len: 3, max_len: 64 }];

	// Session status (see enums.proto)
	SessionStatus status = 12;

	// Authentication and security
	string access_token = 13 [(buf.validate.field).string = { max_len: 2048, ignore_empty: true }];
	string refresh_token = 14 [(buf.validate.field).string = { max_len: 2048, ignore_empty: true }];
	repeated string roles = 15 [(buf.validate.field).repeated.max_items = 20];
	repeated string permissions = 16 [(buf.validate.field).repeated.max_items = 100];

	// Session lifecycle timestamps
	google.protobuf.Timestamp created_at = 21;
	google.protobuf.Timestamp updated_at = 22;
	google.protobuf.Timestamp expires_at = 23;
	google.protobuf.Timestamp terminated_at = 24;

	// Device and network context
	string device_id = 31 [(buf.validate.field).string = { max_len: 128, ignore_empty: true }];
	string ip_address = 32 [(buf.validate.field).string = { ip: true, max_len: 45, ignore_empty: true }];
	string user_agent = 33 [(buf.validate.field).string = { max_len: 512, ignore_empty: true }];
  string fingerprint = 34 [(buf.validate.field).string = { max_len: 256, ignore_empty: true }];

	// Custom metadata for extensibility
	map<string, string> metadata = 41;
}
