syntax = "proto3";

package users.v1;

option go_package = "github.com/geniustechspace/protobuf/gen/go/users/v1;usersv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.users.v1";
option csharp_namespace = "GeniusTechSpace.Protobuf.Users.V1";

import "google/protobuf/timestamp.proto";
import "proto/core/v1/common.proto";

// User represents a user in the system
message User {
  core.v1.Metadata metadata = 1;
  string tenant_id = 2;
  string email = 3;
  string username = 4;
  string first_name = 5;
  string last_name = 6;
  string phone = 7;
  string avatar_url = 8;
  UserStatus status = 9;
  repeated string roles = 10;
  UserPreferences preferences = 11;
  google.protobuf.Timestamp last_login_at = 12;
  bool email_verified = 13;
  bool phone_verified = 14;
}

// UserStatus represents the status of a user
enum UserStatus {
  USER_STATUS_UNSPECIFIED = 0;
  USER_STATUS_ACTIVE = 1;
  USER_STATUS_INACTIVE = 2;
  USER_STATUS_SUSPENDED = 3;
  USER_STATUS_PENDING_VERIFICATION = 4;
}

// UserPreferences stores user-specific preferences
message UserPreferences {
  string language = 1;
  string timezone = 2;
  string date_format = 3;
  string time_format = 4;
  bool notifications_enabled = 5;
  bool email_notifications = 6;
  bool sms_notifications = 7;
  map<string, string> custom_preferences = 8;
}

// CreateUserRequest for creating a new user
message CreateUserRequest {
  string tenant_id = 1;
  string email = 2;
  string username = 3;
  string password = 4;
  string first_name = 5;
  string last_name = 6;
  string phone = 7;
  repeated string roles = 8;
}

// CreateUserResponse returns the created user
message CreateUserResponse {
  User user = 1;
}

// GetUserRequest for retrieving a user
message GetUserRequest {
  string tenant_id = 1;
  string user_id = 2;
}

// GetUserResponse returns the requested user
message GetUserResponse {
  User user = 1;
}

// UpdateUserRequest for updating a user
message UpdateUserRequest {
  string tenant_id = 1;
  string user_id = 2;
  string email = 3;
  string username = 4;
  string first_name = 5;
  string last_name = 6;
  string phone = 7;
  string avatar_url = 8;
  UserPreferences preferences = 9;
}

// UpdateUserResponse returns the updated user
message UpdateUserResponse {
  User user = 1;
}

// DeleteUserRequest for deleting a user
message DeleteUserRequest {
  string tenant_id = 1;
  string user_id = 2;
}

// DeleteUserResponse confirms deletion
message DeleteUserResponse {
  bool success = 1;
}

// ListUsersRequest for listing users
message ListUsersRequest {
  string tenant_id = 1;
  core.v1.PaginationRequest pagination = 2;
  UserStatus status = 3;
  repeated string roles = 4;
  string search_query = 5;
}

// ListUsersResponse returns a list of users
message ListUsersResponse {
  repeated User users = 1;
  core.v1.PaginationResponse pagination = 2;
}

// ChangePasswordRequest for changing user password
message ChangePasswordRequest {
  string tenant_id = 1;
  string user_id = 2;
  string current_password = 3;
  string new_password = 4;
}

// ChangePasswordResponse confirms password change
message ChangePasswordResponse {
  bool success = 1;
}

// UpdateUserStatusRequest for updating user status
message UpdateUserStatusRequest {
  string tenant_id = 1;
  string user_id = 2;
  UserStatus status = 3;
  string reason = 4;
}

// UpdateUserStatusResponse returns the updated user
message UpdateUserStatusResponse {
  User user = 1;
}

// UserService provides user management operations
service UserService {
  // Create a new user
  rpc CreateUser(CreateUserRequest) returns (CreateUserResponse);
  
  // Get a user by ID
  rpc GetUser(GetUserRequest) returns (GetUserResponse);
  
  // Update a user
  rpc UpdateUser(UpdateUserRequest) returns (UpdateUserResponse);
  
  // Delete a user
  rpc DeleteUser(DeleteUserRequest) returns (DeleteUserResponse);
  
  // List users with filtering and pagination
  rpc ListUsers(ListUsersRequest) returns (ListUsersResponse);
  
  // Change user password
  rpc ChangePassword(ChangePasswordRequest) returns (ChangePasswordResponse);
  
  // Update user status
  rpc UpdateUserStatus(UpdateUserStatusRequest) returns (UpdateUserStatusResponse);
}
