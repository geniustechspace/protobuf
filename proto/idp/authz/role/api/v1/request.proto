// DOMAIN: Authorization - Role Management APIRequests
// COMPLIANCE: SOC 2 CC6.1, ISO 27001 A.9.2
// SECURITY: Role-based access control (RBAC)
// PII: No

syntax = "proto3";

package geniustechspace.idp.authz.role.api.v1;

import "buf/validate/validate.proto";
import "core/api/pagination/v1/messages.proto";
import "core/common/v1/common.proto";
import "google/protobuf/field_mask.proto";
import "idp/authz/role/v1/role.proto";

option go_package = "github.com/geniustechspace/protobuf/gen/go/idp/authz/role/api/v1;roleapiv1";

// OFFLINE SUPPORT: role_id can be pre-generated (any string format (UUID, ULID, custom)).
message CreateRoleRequest {
  // Role data to create.
  geniustechspace.idp.authz.role.v1.Role data = 1;

  reserved 2 to 9;
}
message GetRoleRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];

  oneof identifier {
    string role_id = 2 [(buf.validate.field).string.max_len = 512];
    string name = 3 [(buf.validate.field).string.max_len = 512];
  }

  reserved 4 to 9;
}
message UpdateRoleRequest {
  // Role data with fields to update. Must include tenant_path and identifier.
  // REQUIRED: Must contain tenant_path + (role_id OR name) for lookup
  geniustechspace.idp.authz.role.v1.Role data = 1;

  // Field mask specifying which fields to update.
  // EXAMPLES: paths: ["name", "description", "permission_ids"]
  google.protobuf.FieldMask update_mask = 2 [(buf.validate.field).required = true];

  reserved 3 to 9;
}
message DeleteRoleRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  string role_id = 2 [(buf.validate.field).string.max_len = 512];
}
message ListRolesRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  geniustechspace.core.api.pagination.v1.PaginationRequest pagination = 2;
}
message AssignRoleRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  string role_id = 2 [(buf.validate.field).string.max_len = 512];
  geniustechspace.idp.authz.role.v1.SubjectType subject_type = 3 [(buf.validate.field).enum.defined_only = true];
  string subject_id = 4 [(buf.validate.field).string.max_len = 512];
}
message UnassignRoleRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  string assignment_id = 2 [(buf.validate.field).string.max_len = 512];
}
message ListRoleAssignmentsRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  optional string role_id = 2 [(buf.validate.field).string.max_len = 512];
  optional string subject_id = 3 [(buf.validate.field).string.max_len = 512];
  geniustechspace.core.api.pagination.v1.PaginationRequest pagination = 4;
}
