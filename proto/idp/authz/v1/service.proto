// DOMAIN: Identity Provider - Authorization Service
// COMPLIANCE: SOC 2 CC6.1, GDPR Article 5, ISO 27001 A.9.1
// SECURITY: Authentication required, tenant isolation enforced
// PII: Contains user identifiers

syntax = "proto3";

package geniustechspace.idp.authz.v1;

import "idp/authz/v1/messages.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Idp.Authz.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/idp/authz/v1;idpauthzv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.idp.authz.v1";

// AuthorizationService provides authorization operations.
// COMPLIANCE: ISO 27001 A.9.1 (Access Control Policy)
// SECURITY: TLS 1.3+ required, all endpoints require authentication
service AuthorizationService {
  // CheckPermission checks if user has permission for resource action.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: None (checks permission for any user)
  // COMPLIANCE: SOC 2 CC6.1 (Logical Access Controls)
  // RATE LIMIT: 100/sec per user
  rpc CheckPermission(CheckPermissionRequest) returns (CheckPermissionResponse);

  // AssignRole assigns role to user.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Requires 'roles:assign' permission
  // COMPLIANCE: SOC 2 CC6.1 (User Provisioning)
  // RATE LIMIT: 20/min per tenant
  rpc AssignRole(AssignRoleRequest) returns (AssignRoleResponse);

  // RevokeRole revokes role from user.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Requires 'roles:revoke' permission
  // COMPLIANCE: SOC 2 CC6.1 (User De-provisioning)
  // RATE LIMIT: 20/min per tenant
  rpc RevokeRole(RevokeRoleRequest) returns (RevokeRoleResponse);
}
