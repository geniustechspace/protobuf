// DOMAIN: Identity Provider - Standard Protocols Messages
// COMPLIANCE: RFC 6749 (OAuth 2.0), OpenID Connect 1.0, SAML 2.0
// SECURITY: Authentication required, tenant isolation enforced
// PII: May contain user identifiers

syntax = "proto3";

package geniustechspace.idp.protocols.v1;

import "buf/validate/validate.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Idp.Protocols.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/idp/protocols/v1;idpprotocolsv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.idp.protocols.v1";

// OAuth2TokenRequest for OAuth 2.0 token endpoint.
// COMPLIANCE: RFC 6749 Section 4 (Token Endpoint)
message OAuth2TokenRequest {
  // Tenant ID. REQUIRED.
  string tenant_id = 1 [(buf.validate.field).string.min_len = 1];

  // Grant type. REQUIRED.
  OAuth2GrantType grant_type = 2 [(buf.validate.field).enum.defined_only = true];

  // Authorization code. OPTIONAL.
  // Required for authorization_code grant.
  string code = 3;

  // Refresh token. OPTIONAL.
  // Required for refresh_token grant.
  string refresh_token = 4;

  // Client ID. REQUIRED.
  string client_id = 5 [(buf.validate.field).string.min_len = 1];

  // Client secret. OPTIONAL.
  string client_secret = 6;

  // Redirect URI. OPTIONAL.
  string redirect_uri = 7;

  // Scope. OPTIONAL.
  repeated string scope = 8;
}

// OAuth2GrantType represents OAuth 2.0 grant type.
// COMPLIANCE: RFC 6749 Section 1.3
enum OAuth2GrantType {
  GRANT_TYPE_UNSPECIFIED = 0;
  AUTHORIZATION_CODE = 1; // Authorization code grant
  REFRESH_TOKEN = 2; // Refresh token grant
  CLIENT_CREDENTIALS = 3; // Client credentials grant
  PASSWORD = 4; // Resource owner password grant (discouraged)
  reserved 5 to 10;
}

// OAuth2TokenResponse for OAuth 2.0 token endpoint response.
message OAuth2TokenResponse {
  // Access token. REQUIRED.
  string access_token = 1;

  // Token type. REQUIRED.
  // Usually "Bearer".
  string token_type = 2;

  // Expires in. OPTIONAL.
  // Lifetime in seconds.
  int32 expires_in = 3;

  // Refresh token. OPTIONAL.
  string refresh_token = 4;

  // Scope. OPTIONAL.
  repeated string scope = 5;

  // ID token. OPTIONAL.
  // OpenID Connect ID token.
  string id_token = 6;
}
