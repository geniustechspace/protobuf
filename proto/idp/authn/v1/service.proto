// DOMAIN: Identity Provider - Authentication Service
// COMPLIANCE: SOC 2 CC6.1, GDPR Article 5, NIST 800-63B, ISO 27001 A.9.2
// SECURITY: Authentication required (except Authenticate endpoint), tenant isolation enforced
// PII: Contains user identifiers

syntax = "proto3";

package geniustechspace.idp.authn.v1;

import "idp/authn/v1/messages.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Idp.Authn.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/idp/authn/v1;idpauthnv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.idp.authn.v1";

// AuthenticationService provides authentication operations.
// COMPLIANCE: NIST 800-63B (Digital Identity Authentication)
// SECURITY: TLS 1.3+ required, rate limiting enforced
service AuthenticationService {
  // Authenticate initiates authentication with credentials.
  // AUTHENTICATION: Public endpoint (no auth required)
  // AUTHORIZATION: None
  // COMPLIANCE: NIST 800-63B Section 4.1 (Authentication Process)
  // RATE LIMIT: 10/min per IP, 5/min per identifier
  rpc Authenticate(AuthenticateRequest) returns (AuthenticateResponse);

  // VerifyMFA verifies multi-factor authentication.
  // AUTHENTICATION: Requires valid session from Authenticate
  // AUTHORIZATION: Session owner only
  // COMPLIANCE: NIST 800-63B Section 4.3 (Multi-Factor Authenticators)
  // RATE LIMIT: 5/min per session
  rpc VerifyMFA(VerifyMFARequest) returns (VerifyMFAResponse);

  // Logout terminates session and optionally revokes tokens.
  // AUTHENTICATION: Requires valid access token or session
  // AUTHORIZATION: Session/token owner only
  // COMPLIANCE: Session management best practices
  // RATE LIMIT: 20/min per user
  rpc Logout(LogoutRequest) returns (LogoutResponse);
}
