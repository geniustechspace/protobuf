// DOMAIN: Identity Provider - Authentication Enumerations
// COMPLIANCE: SOC 2 CC6.1, GDPR Article 5, NIST 800-63B, ISO 27001 A.9.2
// SECURITY: Authentication required, tenant isolation enforced
// PII: No

syntax = "proto3";

package geniustechspace.idp.authn.v1;

option csharp_namespace = "GeniusTechSpace.Protobuf.Idp.Authn.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/idp/authn/v1;idpauthnv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.idp.authn.v1";

// WebAuthnAuthenticatorAttachment specifies authenticator type preference.
// COMPLIANCE: W3C WebAuthn Level 2 Section 5.4.4
enum WebAuthnAuthenticatorAttachment {
  AUTHENTICATOR_ATTACHMENT_UNSPECIFIED = 0;
  PLATFORM = 1; // Built-in (Touch ID, Face ID, Windows Hello)
  CROSS_PLATFORM = 2; // External (USB, NFC, Bluetooth security keys)
  reserved 3 to 10;
}

// WebAuthnUserVerification specifies user verification requirement.
// COMPLIANCE: W3C WebAuthn Level 2 Section 5.8.6
enum WebAuthnUserVerification {
  USER_VERIFICATION_UNSPECIFIED = 0;
  REQUIRED = 1; // User verification required (biometric, PIN)
  PREFERRED = 2; // User verification preferred if available
  DISCOURAGED = 3; // User verification discouraged (presence only)
  reserved 4 to 10;
}

// WebAuthnAttestationConveyancePreference specifies attestation requirement.
// COMPLIANCE: W3C WebAuthn Level 2 Section 5.4.7
enum WebAuthnAttestationConveyancePreference {
  ATTESTATION_CONVEYANCE_UNSPECIFIED = 0;
  NONE = 1; // No attestation
  INDIRECT = 2; // Anonymized attestation
  DIRECT = 3; // Full attestation with device certificate
  ENTERPRISE = 4; // Enterprise attestation (internal PKI)
  reserved 5 to 10;
}

// WebAuthnAuthenticatorTransport specifies transport method.
// COMPLIANCE: W3C WebAuthn Level 2 Section 5.8.2
enum WebAuthnAuthenticatorTransport {
  AUTHENTICATOR_TRANSPORT_UNSPECIFIED = 0;
  USB = 1; // USB connection
  NFC = 2; // Near Field Communication
  BLE = 3; // Bluetooth Low Energy
  INTERNAL = 4; // Platform authenticator (built-in)
  HYBRID = 5; // Hybrid transport (QR code + BLE)
  reserved 6 to 10;
}

// PasswordStrengthLevel represents password strength assessment.
// COMPLIANCE: NIST 800-63B Section 5.1.1.2 (Password Strength)
enum PasswordStrengthLevel {
  PASSWORD_STRENGTH_UNSPECIFIED = 0;
  VERY_WEAK = 1; // Score 0-20
  WEAK = 2; // Score 21-40
  FAIR = 3; // Score 41-60
  GOOD = 4; // Score 61-80
  STRONG = 5; // Score 81-100
  reserved 6 to 10;
}

// PasswordViolationType represents password policy violation.
enum PasswordViolationType {
  PASSWORD_VIOLATION_UNSPECIFIED = 0;
  TOO_SHORT = 1; // Below minimum length
  TOO_LONG = 2; // Above maximum length
  MISSING_UPPERCASE = 3; // Missing uppercase letter
  MISSING_LOWERCASE = 4; // Missing lowercase letter
  MISSING_DIGIT = 5; // Missing digit
  MISSING_SPECIAL_CHAR = 6; // Missing special character
  COMMON_PASSWORD = 7; // In common password list
  BREACHED_PASSWORD = 8; // Found in breach database (Have I Been Pwned)
  CONTAINS_USERNAME = 9; // Contains username
  CONTAINS_EMAIL = 10; // Contains email
  RECENTLY_USED = 11; // Used in password history
  SEQUENTIAL_CHARACTERS = 12; // Sequential characters (abc, 123)
  REPEATED_CHARACTERS = 13; // Repeated characters (aaa, 111)
  reserved 14 to 30;
}

// TokenRevocationReason specifies why token was revoked.
// COMPLIANCE: RFC 7009 Section 2.1 (Token Revocation)
enum TokenRevocationReason {
  TOKEN_REVOCATION_REASON_UNSPECIFIED = 0;
  USER_LOGOUT = 1; // User initiated logout
  ADMIN_ACTION = 2; // Admin revoked token
  PASSWORD_CHANGED = 3; // User changed password
  SECURITY_CONCERN = 4; // Security threat detected
  TOKEN_EXPIRED = 5; // Token naturally expired
  ACCOUNT_DELETED = 6; // Account deleted
  ACCOUNT_SUSPENDED = 7; // Account suspended
  PERMISSIONS_CHANGED = 8; // User permissions changed
  DEVICE_LOST = 9; // Device reported lost/stolen
  SESSION_TIMEOUT = 10; // Session timed out
  CONCURRENT_SESSION_LIMIT = 11; // Exceeded concurrent session limit
  reserved 12 to 30;
}

// SessionTerminationReason specifies why session was terminated.
enum SessionTerminationReason {
  SESSION_TERMINATION_REASON_UNSPECIFIED = 0;
  USER_LOGOUT = 1; // User initiated logout
  IDLE_TIMEOUT = 2; // Idle timeout reached
  ABSOLUTE_TIMEOUT = 3; // Absolute timeout reached
  ADMIN_ACTION = 4; // Admin terminated session
  SECURITY_CONCERN = 5; // Security threat detected
  PASSWORD_CHANGED = 6; // Password changed
  ACCOUNT_DELETED = 7; // Account deleted
  ACCOUNT_SUSPENDED = 8; // Account suspended
  NEW_LOGIN = 9; // New login on another device
  DEVICE_LOST = 10; // Device reported lost/stolen
  reserved 11 to 30;
}
