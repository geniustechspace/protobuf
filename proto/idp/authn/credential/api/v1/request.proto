// DOMAIN: Authentication - Credential Management APIRequests
// COMPLIANCE: NIST 800-63B, SOC 2 CC6.1, ISO 27001 A.9.4
// SECURITY: Sensitive operations, credential hashing required
// PII: Yes - Credentials contain authentication secrets

syntax = "proto3";

package geniustechspace.idp.authn.credential.api.v1;

import "buf/validate/validate.proto";
import "core/api/pagination/v1/messages.proto";
import "google/protobuf/field_mask.proto";
import "idp/authn/credential/v1/credential.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Idp.Authn.Credential.Api.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/idp/authn/credential/api/v1;credentialapiv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.idp.authn.credential.api.v1";

// OFFLINE SUPPORT: credential_id can be pre-generated (any string format (UUID, ULID, custom)).
message CreateCredentialRequest {
  // Credential data to create.
  // SECURITY: secret will be hashed by server
  geniustechspace.idp.authn.credential.v1.Credential data = 1;

  reserved 2 to 9;
}
message GetCredentialRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];

  oneof identifier {
    string credential_id = 2 [(buf.validate.field).string.max_len = 512];
  }

  reserved 3 to 9;
}
message ValidateCredentialRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  string user_id = 2 [(buf.validate.field).string.max_len = 512];
  geniustechspace.idp.authn.credential.v1.CredentialType type = 3 [(buf.validate.field).enum.defined_only = true];
  string secret = 4 [(buf.validate.field).string.max_len = 512];
}
message UpdateCredentialRequest {
  // Credential data with fields to update. Must include tenant_path and credential_id.
  // REQUIRED: Must contain tenant_path + credential_id for lookup
  // SECURITY: Secret will be re-hashed if included
  geniustechspace.idp.authn.credential.v1.Credential data = 1;

  // Field mask specifying which fields to update.
  // EXAMPLES: paths: ["metadata.device_id"], paths: ["secret"]
  google.protobuf.FieldMask update_mask = 2 [(buf.validate.field).required = true];

  reserved 3 to 9;
}
message RevokeCredentialRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  string credential_id = 2 [(buf.validate.field).string.max_len = 512];
  string reason = 3 [(buf.validate.field).string.max_len = 500];
}
message ListCredentialsRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  string user_id = 2 [(buf.validate.field).string.max_len = 512];
  geniustechspace.core.api.pagination.v1.PaginationRequest pagination = 3;
}
message RotateCredentialRequest {
  string tenant_path = 1 [(buf.validate.field).string.max_len = 512];
  string credential_id = 2 [(buf.validate.field).string.max_len = 512];
  string new_secret = 3 [(buf.validate.field).string.max_len = 512];
}
