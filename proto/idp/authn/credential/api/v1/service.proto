// DOMAIN: Authentication - Credential Management API Service
// COMPLIANCE: NIST 800-63B, SOC 2 CC6.1, ISO 27001 A.9.4
// SECURITY: Sensitive operations, credential hashing required
// PII: Yes - Credentials contain authentication secrets

syntax = "proto3";

package geniustechspace.idp.authn.credential.api.v1;

import "idp/authn/credential/api/v1/request.proto";
import "idp/authn/credential/api/v1/response.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Idp.Authn.Credential.Api.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/idp/authn/credential/api/v1;credentialapiv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.idp.authn.credential.api.v1";

// CredentialService manages user authentication credentials.
// SECURITY: All operations require authentication.
// RATE LIMITS: See individual method documentation.
service CredentialService {
  // CreateCredential creates new credential for user.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Requires 'credentials:create' permission
  // RATE LIMIT: 20/min per user
  rpc CreateCredential(CreateCredentialRequest) returns (CreateCredentialResponse);

  // GetCredential retrieves credential by ID.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Self or 'credentials:read' permission
  // RATE LIMIT: 100/min per user
  rpc GetCredential(GetCredentialRequest) returns (GetCredentialResponse);

  // ValidateCredential validates credential secret.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Self or 'credentials:validate' permission
  // RATE LIMIT: 10/min per user (brute force protection)
  rpc ValidateCredential(ValidateCredentialRequest) returns (ValidateCredentialResponse);

  // UpdateCredential updates existing credential.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Self or 'credentials:update' permission
  // RATE LIMIT: 20/min per user
  rpc UpdateCredential(UpdateCredentialRequest) returns (UpdateCredentialResponse);

  // RevokeCredential revokes credential.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Self or 'credentials:revoke' permission
  // RATE LIMIT: 20/min per user
  rpc RevokeCredential(RevokeCredentialRequest) returns (RevokeCredentialResponse);

  // ListCredentials lists credentials for user.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Self or 'credentials:list' permission
  // RATE LIMIT: 50/min per user
  rpc ListCredentials(ListCredentialsRequest) returns (ListCredentialsResponse);

  // RotateCredential rotates credential secret.
  // AUTHENTICATION: Required - valid bearer token
  // AUTHORIZATION: Self or 'credentials:rotate' permission
  // RATE LIMIT: 5/hour per credential (security measure)
  rpc RotateCredential(RotateCredentialRequest) returns (RotateCredentialResponse);
}
