// Core Metadata and Pagination - Version 1
//
// This module defines metadata structures for audit trails, versioning, and
// pagination controls used across all domain entities.
//
// PURPOSE: Provides consistent audit trails, optimistic locking, and soft delete
//          capabilities for all domain entities.
//
// COMPLIANCE: SOC 2 CC6.3 (Change management), GDPR Article 5(2) (Accountability)
// AUDIT: Complete history tracking for compliance and forensics

syntax = "proto3";

package core.v1;

import "google/protobuf/timestamp.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Core.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/core/v1;corev1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.core.v1";

// TenantContext enforces multi-tenant data isolation across all operations.
//
// PURPOSE: Ensures tenant isolation and prevents cross-tenant data access
// COMPLIANCE: SOC 2 CC6.1 (Logical access controls), ISO 27001 A.9.4.1 (Access control policy)
// SECURITY: MUST be included in all requests to enforce tenant boundaries
// ARCHITECTURE: Middleware should extract and validate tenant context from authentication
message TenantContext {
  // Unique tenant identifier. REQUIRED for all operations.
  // VALIDATION: Must match authenticated user's tenant
  // COMPLIANCE: Critical for SOC 2 tenant isolation requirements
  // FORMAT: UUID v4 recommended
  // Example: "tenant_01HQZX5J8K9M3N4P5Q6R7S8T9V"
  string tenant_id = 1;

  // Display name of the tenant. Used for UI and reporting only.
  // OPTIONAL: Can be populated for logging and display purposes
  // Example: "Acme Corporation", "Startup Inc"
  string tenant_name = 2;

  // Tenant subscription tier determining feature access. Optional.
  // PURPOSE: Used for feature flagging and quota enforcement
  // VALUES: "free", "starter", "professional", "enterprise"
  // USAGE: Service layer checks tier for feature availability
  string tier = 3;

  // Current tenant status affecting API access. Optional.
  // COMPLIANCE: SOC 2 CC6.2 (Access termination)
  // VALUES: "active", "suspended", "trial", "inactive", "deleted"
  // BEHAVIOR: Non-active status may block API access
  string status = 4;
}

// Metadata provides comprehensive audit trail and version control for all entities.
//
// PURPOSE: Complete audit trail for compliance, versioning for optimistic locking,
//          and soft delete support for data retention requirements
// COMPLIANCE: SOC 2 CC6.3 (Change management), GDPR Article 5(2) (Accountability)
// AUDIT: Tracks who created/modified entities and when for forensic analysis
// USAGE: Embedded in all domain entities (User, Tenant, Role, Subscription, etc.)
message Metadata {
  // Unique entity identifier. REQUIRED, immutable after creation.
  // FORMAT: UUID v4 recommended for global uniqueness
  // GENERATION: Generated server-side on entity creation
  // Example: "usr_01HQZX5J8K9M3N4P5Q6R7S8T9V"
  string id = 1;

  // Entity creation timestamp. REQUIRED, immutable.
  // COMPLIANCE: SOC 2 CC6.3 audit requirement for entity lifecycle tracking
  // TIMEZONE: Always UTC
  // GENERATION: Set automatically on entity creation
  google.protobuf.Timestamp created_at = 2;

  // Last modification timestamp. REQUIRED, automatically updated.
  // PURPOSE: Tracks when entity was last changed for cache invalidation and auditing
  // TIMEZONE: Always UTC
  // BEHAVIOR: Updated automatically on every entity modification
  google.protobuf.Timestamp updated_at = 3;

  // User ID who created this entity. REQUIRED for audit trail.
  // COMPLIANCE: SOC 2 CC6.3 - Required for accountability and compliance audits
  // FORMAT: User ID from authentication context
  // Example: "usr_01HQZX5J8K9M3N4P5Q6R7S8T9V"
  string created_by = 4;

  // User ID who last modified this entity. REQUIRED for audit trail.
  // COMPLIANCE: SOC 2 CC6.3 - Tracks who made changes for accountability
  // BEHAVIOR: Updated on every modification to reflect current modifier
  // Example: "usr_01HQZX5J8K9M3N4P5Q6R7S8T9V"
  string updated_by = 5;

  // Version number for optimistic locking preventing concurrent update conflicts.
  // REQUIRED for entities supporting concurrent modifications.
  // PURPOSE: Prevents lost updates in distributed systems
  //
  // BEHAVIOR:
  //   - Starts at 1 on entity creation
  //   - Incremented on every update
  //   - Update fails if client version doesn't match current version
  //
  // USAGE:
  //   1. Client reads entity with version=5
  //   2. Client modifies entity locally
  //   3. Client sends update with version=5
  //   4. Server checks: if current version != 5, reject update (conflict)
  //   5. Server increments version to 6 on successful update
  int64 version = 6;

  // Soft delete flag indicating logical deletion without physical removal.
  // REQUIRED for entities with data retention requirements.
  // COMPLIANCE: GDPR Article 17 (Right to erasure with retention requirements)
  // PURPOSE: Allows "deletion" while retaining data for:
  //   - Audit trails and compliance investigations
  //   - Referential integrity in related records
  //   - Legal holds and e-discovery
  //
  // BEHAVIOR:
  //   - When true, entity is hidden from normal queries
  //   - Special queries needed to retrieve deleted entities
  //   - Physical deletion may occur after retention period
  bool deleted = 7;

  // Deletion timestamp set when entity is soft deleted. Optional.
  // BEHAVIOR: Set automatically when deleted flag changes to true
  // PURPOSE: Track deletion time for retention policy enforcement
  // COMPLIANCE: Required for demonstrating retention policy compliance
  google.protobuf.Timestamp deleted_at = 8;
}
