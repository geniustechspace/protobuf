// Core API Request Messages - Generic CRUD Request Pattern
//
// Provides standardized request structure for all domain CRUD operations.
// Simple, flexible, and reusable across all domains.
//
// DOMAIN: Core - API Standards
// VERSION: v1

syntax = "proto3";

package geniustechspace.core.api.request.v1;

import "buf/validate/validate.proto";
import "core/api/query/v1/query.proto";
import "google/protobuf/any.proto";
import "google/protobuf/field_mask.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Core.Api.Request.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/core/api/request/v1;requestv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.core.api.request.v1";

// ==================== GENERIC REQUEST ====================

// Request is the generic contract for custom operations.
message Request {
  google.protobuf.Any data = 1;
  // Comprehensive query (filter, sort, pagination, projection, etc.)
  geniustechspace.core.api.query.v1.Query query = 2;
  string idempotency_key = 3 [(buf.validate.field).string.max_len = 128];
  bool dry_run = 4;
  google.protobuf.FieldMask field_mask = 5;
  map<string, string> options = 6 [(buf.validate.field).map.max_pairs = 20];
}

// ==================== CREATE ====================

// CreateRequest for single entity creation.
message CreateRequest {
  google.protobuf.Any data = 1 [(buf.validate.field).required = true];
  string idempotency_key = 2 [(buf.validate.field).string.max_len = 128];
  bool dry_run = 3;
  google.protobuf.FieldMask field_mask = 4;
}

// BatchCreateRequest for bulk entity creation.
message BatchCreateRequest {
  repeated google.protobuf.Any data = 1 [(buf.validate.field).repeated = {
    min_items: 1
    max_items: 1000
  }];
  string idempotency_key = 2 [(buf.validate.field).string.max_len = 128];
  bool continue_on_error = 3;
  bool dry_run = 4;
  google.protobuf.FieldMask field_mask = 5;
}

// ==================== READ ====================

// GetRequest for retrieving a single entity.
message GetRequest {
  string id = 1 [(buf.validate.field).string = {
    min_len: 1
    max_len: 128
  }];
  google.protobuf.FieldMask field_mask = 2;
  bool include_deleted = 3;
}

// ListRequest for retrieving multiple entities.
// Uses the comprehensive Query system for filtering, sorting, pagination, etc.
message ListRequest {
  // Comprehensive query (filter, sort, pagination, projection, etc.)
  geniustechspace.core.api.query.v1.Query query = 1;
}

// SearchRequest for full-text search.
// Uses the comprehensive Query system with search capabilities.
message SearchRequest {
  // Comprehensive query with search
  geniustechspace.core.api.query.v1.Query query = 1 [(buf.validate.field).required = true];
}

// ==================== UPDATE ====================

// UpdateRequest for updating a single entity.
message UpdateRequest {
  string id = 1 [(buf.validate.field).string = {
    min_len: 1
    max_len: 128
  }];
  google.protobuf.Any data = 2 [(buf.validate.field).required = true];
  google.protobuf.FieldMask field_mask = 3 [(buf.validate.field).required = true];
  int64 version = 4;
  string idempotency_key = 5 [(buf.validate.field).string.max_len = 128];
  bool dry_run = 6;
}

// BatchUpdateRequest for bulk updates.
message BatchUpdateRequest {
  repeated UpdateRequest updates = 1 [(buf.validate.field).repeated = {
    min_items: 1
    max_items: 1000
  }];
  string idempotency_key = 2 [(buf.validate.field).string.max_len = 128];
  bool continue_on_error = 3;
  bool dry_run = 4;
}

// ==================== DELETE ====================

// DeleteRequest for deleting a single entity.
message DeleteRequest {
  string id = 1 [(buf.validate.field).string = {
    min_len: 1
    max_len: 128
  }];
  bool hard_delete = 2;
  int64 version = 3;
  string idempotency_key = 4 [(buf.validate.field).string.max_len = 128];
}

// BatchDeleteRequest for bulk deletes.
message BatchDeleteRequest {
  repeated string ids = 1 [(buf.validate.field).repeated = {
    min_items: 1
    max_items: 1000
    items: {
      string: {
        min_len: 1
        max_len: 128
      }
    }
  }];
  bool hard_delete = 2;
  string idempotency_key = 3 [(buf.validate.field).string.max_len = 128];
  bool continue_on_error = 4;
}

// ==================== UTILITIES ====================

// RestoreRequest for restoring soft-deleted entities.
message RestoreRequest {
  string id = 1 [(buf.validate.field).string = {
    min_len: 1
    max_len: 128
  }];
  string idempotency_key = 2 [(buf.validate.field).string.max_len = 128];
}

// CountRequest for counting entities.
// Uses the comprehensive Query system for filtering.
message CountRequest {
  // Query for counting (only filter used)
  geniustechspace.core.api.query.v1.Query query = 1;
}

// ExistsRequest for checking entity existence.
message ExistsRequest {
  string id = 1 [(buf.validate.field).string = {
    min_len: 1
    max_len: 128
  }];
  bool include_deleted = 2;
}
