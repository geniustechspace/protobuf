// Access Policy Domain Events
//
// Events for role/permission changes, policy updates, and access control
// decisions for security audit trails and compliance reporting.
//
// COMPLIANCE: SOC 2 CC6.1, CC6.2 (Access control audit), ISO 27001 A.9.2
// SECURITY: Permission check events enable security monitoring and anomaly detection
// USAGE: Wrap in core.v1.BaseEvent for event sourcing

syntax = "proto3";

package access_policy.v1;

import "google/protobuf/timestamp.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.AccessPolicy.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/access_policy/v1;accesspolicyv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.accesspolicy.v1";

// RoleCreatedEvent published when new role is defined.
// COMPLIANCE: SOC 2 CC6.1 (Role creation audit)
message RoleCreatedEvent {
  string role_id = 1;
  string tenant_id = 2;
  string name = 3;
  google.protobuf.Timestamp created_at = 4;
  int32 permissions_count = 5;
}

// RoleUpdatedEvent is triggered when a role is updated
message RoleUpdatedEvent {
  string role_id = 1;
  string tenant_id = 2;
  google.protobuf.Timestamp updated_at = 3;
  repeated string changed_fields = 4;
}

// RoleDeletedEvent is triggered when a role is deleted
message RoleDeletedEvent {
  string role_id = 1;
  string tenant_id = 2;
  google.protobuf.Timestamp deleted_at = 3;
}

// RoleAssignedEvent is triggered when a role is assigned to a user
message RoleAssignedEvent {
  string user_id = 1;
  string tenant_id = 2;
  string role_id = 3;
  string role_name = 4;
  google.protobuf.Timestamp assigned_at = 5;
}

// RoleRevokedEvent is triggered when a role is revoked from a user
message RoleRevokedEvent {
  string user_id = 1;
  string tenant_id = 2;
  string role_id = 3;
  string role_name = 4;
  google.protobuf.Timestamp revoked_at = 5;
}

// PermissionCheckedEvent is triggered when a permission check is performed
message PermissionCheckedEvent {
  string user_id = 1;
  string tenant_id = 2;
  string resource = 3;
  string action = 4;
  bool allowed = 5;
  google.protobuf.Timestamp checked_at = 6;
}

// PolicyCreatedEvent is triggered when a new policy is created
message PolicyCreatedEvent {
  string policy_id = 1;
  string tenant_id = 2;
  string name = 3;
  google.protobuf.Timestamp created_at = 4;
}

// PolicyUpdatedEvent is triggered when a policy is updated
message PolicyUpdatedEvent {
  string policy_id = 1;
  string tenant_id = 2;
  google.protobuf.Timestamp updated_at = 3;
}
