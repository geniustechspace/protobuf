// IDP Password Messages - Version 1
//
// Password management operation messages.
//
// COMPLIANCE:
//   - NIST 800-63B: Password requirements and policies
//   - OWASP: Password storage and reset best practices
//   - PCI DSS: Password change enforcement
//   - SOC 2: Password policy audit

syntax = "proto3";

package geniustechspace.idp.v1.password;

option csharp_namespace = "GeniusTechSpace.Protobuf.Idp.V1.Password";
option go_package = "github.com/geniustechspace/protobuf/gen/go/idp/v1/password;password";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.idp.v1.password";

// ResetPasswordRequest initiates password reset
message ResetPasswordRequest {
  reserved 3 to 10;
  
  // User identifier
  oneof identifier {
    string email = 1;
    string username = 2;
  }
}

// ResetPasswordResponse confirms reset initiated
message ResetPasswordResponse {
  reserved 3 to 10;
  
  // Success flag (always true to prevent user enumeration)
  bool success = 1;

  // User-facing message
  string message = 2;
}

// ConfirmPasswordResetRequest confirms password reset with token
message ConfirmPasswordResetRequest {
  reserved 3 to 10;
  
  // Reset token from email
  string reset_token = 1;

  // New password
  string new_password = 2;
}

// ConfirmPasswordResetResponse confirms password was reset
message ConfirmPasswordResetResponse {
  reserved 3 to 10;
  
  // Success flag
  bool success = 1;

  // User-facing message
  string message = 2;
}

// ChangePasswordRequest changes password for authenticated user
message ChangePasswordRequest {
  reserved 3 to 10;
  
  // Current password
  string current_password = 1;

  // New password
  string new_password = 2;
}

// ChangePasswordResponse confirms password change
message ChangePasswordResponse {
  reserved 4 to 10;
  
  bool success = 1;
  string message = 2;
  
  // Optional: Whether other sessions were invalidated
  bool sessions_invalidated = 3;
}
