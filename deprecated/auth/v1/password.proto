// Password Management Messages - Version 1
//
// Password reset, change, and validation operations.
// Implements NIST 800-63B password guidelines and enterprise security policies.
//
// COMPLIANCE: NIST 800-63B (Password Guidelines), SOC 2 CC6.1
// SECURITY: Password data must be encrypted in transit and never logged

syntax = "proto3";

package auth.v1;

import "google/protobuf/timestamp.proto";
import "auth/v1/enums.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Auth.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/auth/v1;authv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.auth.v1";

// ============================================================================
// PASSWORD RESET FLOW
// ============================================================================

// PasswordResetRequest initiates password reset flow
message PasswordResetRequest {
  reserved 4 to 10;

  // User identifier
  oneof identifier {
    string email = 1;
    string username = 2;
    string phone = 3;
  }

  // Tenant ID
  string tenant_id = 11;

  // Callback URL for reset link
  string callback_url = 12;
}

// PasswordResetResponse returns reset token or confirmation
message PasswordResetResponse {
  reserved 3 to 10;

  // Reset token (if direct token return is enabled)
  string reset_token = 1;

  // Expiration time
  google.protobuf.Timestamp expires_at = 2;

  // User-facing message
  string message = 11;
}

// PasswordResetConfirmRequest confirms new password
message PasswordResetConfirmRequest {
  reserved 4 to 10;

  // Reset token from email/SMS
  string reset_token = 1;

  // New password
  string new_password = 2;

  // Password confirmation
  string new_password_confirm = 3;

  // Login after reset
  bool login_after_reset = 11;

  // Logout other sessions
  bool logout_other_sessions = 12;
}

// PasswordResetConfirmResponse confirms password was reset
message PasswordResetConfirmResponse {
  reserved 2 to 10;

  // Success flag
  bool success = 1;

  // User-facing message
  string message = 11;
}

// ============================================================================
// PASSWORD CHANGE (AUTHENTICATED)
// ============================================================================

// PasswordChangeRequest changes password for authenticated user
message PasswordChangeRequest {
  reserved 4 to 10;

  // Current password
  string current_password = 1;

  // New password
  string new_password = 2;

  // Password confirmation
  string new_password_confirm = 3;

  // Reason for change
  PasswordChangeReason reason = 11;
}

// PasswordChangeResponse confirms password change
message PasswordChangeResponse {
  reserved 2 to 10;

  // Success flag
  bool success = 1;

  // User-facing message
  string message = 11;

  // Whether to invalidate other sessions
  bool sessions_invalidated = 12;
}

// ============================================================================
// PASSWORD VALIDATION
// ============================================================================

// PasswordValidationRequest validates password against policy
message PasswordValidationRequest {
  reserved 3 to 10;

  // Password to validate
  string password = 1;

  // User ID (for personalized validation)
  string user_id = 2;

  // Tenant ID
  string tenant_id = 11;
}

// PasswordValidationResponse returns validation results
message PasswordValidationResponse {
  reserved 3 to 10;

  // Overall validity
  bool valid = 1;

  // Validation errors
  repeated string errors = 2;

  // Password strength score (0-100)
  int32 strength_score = 11;

  // Strength level
  PasswordPolicyStrength strength_level = 12;

  // Whether password found in breach database
  bool breached = 13;
}
