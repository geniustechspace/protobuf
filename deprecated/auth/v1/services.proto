// Authentication Services - Version 1
//
// Enterprise IDP services covering authentication, authorization, and identity management.
// Provides OAuth2, OIDC, SAML, WebAuthn, MFA, and session management.
//
// COMPLIANCE: OAuth 2.0 (RFC 6749), OIDC Core 1.0, SAML 2.0, NIST 800-63B
// SECURITY: All endpoints require TLS, implement rate limiting and CSRF protection
// USAGE: Core authentication and authorization service definitions

syntax = "proto3";

package auth.v1;

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";
import "proto/datastructure/v1/device/messages.proto";
import "proto/datastructure/v1/client/messages.proto";
import "proto/datastructure/v1/session/messages.proto";
import "proto/datastructure/v1/auth/messages.proto";
import "auth/v1/enums.proto";
import "auth/v1/authentication.proto";
import "auth/v1/password.proto";
import "auth/v1/session.proto";
import "auth/v1/tokens.proto";
import "auth/v1/proofs.proto";
import "auth/v1/webauthn.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Auth.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/auth/v1;authv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.auth.v1";

// ============================================================================
// AUTHENTICATION SERVICE
// ============================================================================

// AuthenticationService handles user authentication flows
service AuthenticationService {
  // Authenticate user with credentials (username/password, OTP, etc.)
  rpc Authenticate(AuthenticationRequest) returns (AuthenticationResponse);

  // Continue multi-step authentication flow
  rpc ContinueAuthentication(AuthenticationRequest) returns (AuthenticationResponse);

  // Logout user and invalidate session
  rpc Logout(LogoutRequest) returns (LogoutResponse);

  // Verify authentication status
  rpc VerifyAuthentication(VerifyAuthenticationRequest) returns (VerifyAuthenticationResponse);

  // Refresh access token using refresh token
  rpc RefreshToken(TokenRefreshRequest) returns (TokenRefreshResponse);

  // Validate token
  rpc ValidateToken(TokenIntrospectRequest) returns (TokenIntrospectResponse);

  // Initiate passwordless authentication
  rpc InitiatePasswordless(PasswordlessInitRequest) returns (PasswordlessInitResponse);

  // Verify passwordless authentication
  rpc VerifyPasswordless(AuthenticationRequest) returns (AuthenticationResponse);
}

// ============================================================================
// PASSWORD MANAGEMENT SERVICE
// ============================================================================

// PasswordService handles password operations
service PasswordService {
  // Request password reset
  rpc RequestPasswordReset(PasswordResetRequest) returns (PasswordResetResponse);

  // Confirm password reset with token
  rpc ConfirmPasswordReset(PasswordResetConfirmRequest) returns (PasswordResetConfirmResponse);

  // Change password for authenticated user
  rpc ChangePassword(PasswordChangeRequest) returns (PasswordChangeResponse);

  // Validate password against policy
  rpc ValidatePassword(PasswordValidationRequest) returns (PasswordValidationResponse);

  // Get password policy
  rpc GetPasswordPolicy(GetPasswordPolicyRequest) returns (GetPasswordPolicyResponse);
}

// ============================================================================
// MFA SERVICE
// ============================================================================

// MFAService manages multi-factor authentication
service MFAService {
  // Enroll MFA method
  rpc EnrollMFA(MFAEnrollRequest) returns (MFAEnrollResponse);

  // Verify MFA enrollment
  rpc VerifyMFAEnrollment(MFAVerifyEnrollmentRequest) returns (MFAVerifyEnrollmentResponse);

  // Request MFA challenge
  rpc RequestMFAChallenge(MFAVerificationRequest) returns (MFAVerificationResponse);

  // Verify MFA response
  rpc VerifyMFA(MFAVerifyRequest) returns (MFAVerifyResponse);

  // List user's MFA methods
  rpc ListMFAMethods(MFAListRequest) returns (MFAListResponse);

  // Disable MFA method
  rpc DisableMFA(MFADisableRequest) returns (MFADisableResponse);

  // Generate backup codes
  rpc GenerateBackupCodes(BackupCodesGenerateRequest) returns (BackupCodesGenerateResponse);

  // Get remaining backup codes count
  rpc GetBackupCodesStatus(BackupCodesStatusRequest) returns (BackupCodesStatusResponse);
}

// ============================================================================
// WEBAUTHN SERVICE
// ============================================================================

// WebAuthnService manages WebAuthn/FIDO2 authentication
service WebAuthnService {
  // Get registration options
  rpc GetRegistrationOptions(WebAuthnRegistrationOptionsRequest) returns (WebAuthnRegistrationOptionsResponse);

  // Register WebAuthn credential
  rpc RegisterCredential(WebAuthnRegistrationRequest) returns (WebAuthnRegistrationResponse);

  // Get authentication options
  rpc GetAuthenticationOptions(WebAuthnAuthenticationOptionsRequest) returns (WebAuthnAuthenticationOptionsResponse);

  // Authenticate with WebAuthn
  rpc Authenticate(WebAuthnAuthenticationRequest) returns (WebAuthnAuthenticationResponse);

  // List user's credentials
  rpc ListCredentials(WebAuthnCredentialListRequest) returns (WebAuthnCredentialListResponse);

  // Update credential metadata
  rpc UpdateCredential(WebAuthnCredentialUpdateRequest) returns (WebAuthnCredentialUpdateResponse);

  // Delete credential
  rpc DeleteCredential(WebAuthnCredentialDeleteRequest) returns (WebAuthnCredentialDeleteResponse);
}

// ============================================================================
// SESSION MANAGEMENT SERVICE
// ============================================================================

// SessionService manages user sessions
service SessionService {
  // Get current session info
    rpc GetSession(GetSessionRequest) returns (geniustechspace.datastructure.v1.session.Session);

  // List user's sessions
  rpc ListSessions(SessionListRequest) returns (SessionListResponse);

  // Revoke specific session
  rpc RevokeSession(SessionRevokeRequest) returns (SessionRevokeResponse);

  // Revoke all sessions
  rpc RevokeAllSessions(SessionRevokeAllRequest) returns (SessionRevokeAllResponse);

  // Extend session expiration
  rpc ExtendSession(ExtendSessionRequest) returns (ExtendSessionResponse);
}

// ============================================================================
// TOKEN MANAGEMENT SERVICE
// ============================================================================

// TokenService manages token lifecycle
service TokenService {
  // Introspect token
  rpc IntrospectToken(TokenIntrospectRequest) returns (TokenIntrospectResponse);

  // Revoke token
  rpc RevokeToken(TokenRevokeRequest) returns (TokenRevokeResponse);

  // Revoke all user tokens
  rpc RevokeAllTokens(TokenRevokeAllRequest) returns (TokenRevokeAllResponse);

  // Rotate tokens
  rpc RotateToken(TokenRotateRequest) returns (TokenRotateResponse);

  // Create API key
  rpc CreateApiKey(ApiKeyCreateRequest) returns (ApiKeyCreateResponse);

  // List API keys
  rpc ListApiKeys(ApiKeyListRequest) returns (ApiKeyListResponse);

  // Revoke API key
  rpc RevokeApiKey(ApiKeyRevokeRequest) returns (ApiKeyRevokeResponse);
}

// ============================================================================
// OAUTH2 SERVICE
// ============================================================================

// OAuth2Service implements OAuth2 authorization server
service OAuth2Service {
  // Authorization endpoint - initiate OAuth2 flow
  rpc Authorize(OAuth2AuthorizeRequest) returns (OAuth2AuthorizeResponse);

  // Token endpoint - exchange code for tokens
  rpc Token(OAuth2TokenRequest) returns (OAuth2TokenResponse);

  // Token introspection endpoint
  rpc IntrospectToken(TokenIntrospectRequest) returns (TokenIntrospectResponse);

  // Token revocation endpoint
  rpc RevokeToken(TokenRevokeRequest) returns (TokenRevokeResponse);

  // Device authorization endpoint
  rpc DeviceAuthorization(OAuth2DeviceAuthorizationRequest) returns (OAuth2DeviceAuthorizationResponse);

  // UserInfo endpoint (OIDC)
  rpc GetUserInfo(OAuth2UserInfoRequest) returns (OAuth2UserInfoResponse);

  // Register OAuth2 client
  rpc RegisterClient(OAuth2ClientRegisterRequest) returns (OAuth2ClientRegisterResponse);

  // Get client metadata
  rpc GetClient(OAuth2ClientGetRequest) returns (OAuth2ClientInfo);

  // Update client metadata
  rpc UpdateClient(OAuth2ClientUpdateRequest) returns (OAuth2ClientInfo);

  // Delete client
  rpc DeleteClient(OAuth2ClientDeleteRequest) returns (google.protobuf.Empty);
}

// ============================================================================
// SOCIAL LOGIN SERVICE
// ============================================================================

// SocialLoginService handles social provider authentication
service SocialLoginService {
  // Get social login authorization URL
  rpc GetAuthorizationUrl(SocialLoginAuthUrlRequest) returns (SocialLoginAuthUrlResponse);

  // Authenticate with social provider
  rpc Authenticate(SocialLoginAuthenticateRequest) returns (AuthenticationResponse);

  // Link social account to existing user
  rpc LinkAccount(SocialLinkAccountRequest) returns (SocialLinkAccountResponse);

  // Unlink social account
  rpc UnlinkAccount(SocialUnlinkAccountRequest) returns (SocialUnlinkAccountResponse);

  // List linked social accounts
  rpc ListLinkedAccounts(SocialListAccountsRequest) returns (SocialListAccountsResponse);
}

// ============================================================================
// SAML SERVICE
// ============================================================================

// SAMLService handles SAML 2.0 authentication
service SAMLService {
  // Initiate SAML SSO (SP-initiated)
  rpc InitiateSSORequest(SAMLInitiateSSORequest) returns (SAMLInitiateSSOResponse);

  // Process SAML assertion (IDP response)
  rpc ProcessAssertion(SAMLProcessAssertionRequest) returns (AuthenticationResponse);

  // Get SAML metadata
  rpc GetMetadata(SAMLGetMetadataRequest) returns (SAMLMetadataResponse);

  // Single Logout Request
  rpc InitiateSLO(SAMLInitiateSLORequest) returns (SAMLInitiateSLOResponse);

  // Process SLO response
  rpc ProcessSLOResponse(SAMLProcessSLORequest) returns (SAMLProcessSLOResponse);
}

// ============================================================================
// SUPPORTING MESSAGES
// ============================================================================

// LogoutRequest requests session termination
message LogoutRequest {
  reserved 3 to 10;

  // Refresh token (optional)
  string refresh_token = 1;

  // Revoke all sessions
  bool revoke_all_sessions = 2;

  // Tenant ID
  string tenant_id = 11;
}

// LogoutResponse confirms logout
message LogoutResponse {
  reserved 2 to 10;

  // Success flag
  bool success = 1;

  // User-facing message
  string message = 11;
}

// VerifyAuthenticationRequest checks auth status
message VerifyAuthenticationRequest {
  reserved 2 to 10;

  // Access token to verify
  string access_token = 1;

  // Tenant ID
  string tenant_id = 11;
}

// VerifyAuthenticationResponse returns auth status
message VerifyAuthenticationResponse {
  reserved 5 to 10;

  // Authentication valid
  bool valid = 1;

  // User ID
  string user_id = 2;

  // Tenant ID
  string tenant_id = 3;

  // Session ID
  string session_id = 4;

  // Roles
  repeated string roles = 11;

  // Permissions
  repeated string permissions = 12;
}

// GetSessionRequest requests current session
message GetSessionRequest {
  reserved 2 to 10;

  // Session ID (optional, defaults to current)
  string session_id = 1;

  // Tenant ID
  string tenant_id = 11;
}

// ExtendSessionRequest extends session expiration
message ExtendSessionRequest {
  reserved 3 to 10;

  // Session ID (optional, defaults to current)
  string session_id = 1;

  // Extension duration in seconds
  int64 extend_by_seconds = 2;

  // Tenant ID
  string tenant_id = 11;
}

// ExtendSessionResponse confirms extension
message ExtendSessionResponse {
  reserved 3 to 10;

  // Success flag
  bool success = 1;

  // New expiration timestamp
  google.protobuf.Timestamp expires_at = 2;

  // User-facing message
  string message = 11;
}

// GetPasswordPolicyRequest requests password policy
message GetPasswordPolicyRequest {
  reserved 2 to 10;

  // Tenant ID
  string tenant_id = 1;
}

// GetPasswordPolicyResponse returns password policy
message GetPasswordPolicyResponse {
  reserved 2 to 10;

  // Password policy
  PasswordPolicy policy = 1;
}

// PasswordPolicy defines password requirements
message PasswordPolicy {
  reserved 11 to 30;

  // Minimum length
  int32 min_length = 1;

  // Maximum length
  int32 max_length = 2;

  // Require uppercase
  bool require_uppercase = 3;

  // Require lowercase
  bool require_lowercase = 4;

  // Require digits
  bool require_digits = 5;

  // Require special characters
  bool require_special = 6;

  // Special characters allowed
  string special_characters = 7;

  // Password expiration days (0 = no expiration)
  int32 expiration_days = 8;

  // Password history count
  int32 history_count = 9;

  // Check against breach database
  bool check_breaches = 10;

  // Strength level
  PasswordPolicyStrength strength = 31;
}

// MFA-related messages (continuing from above)
message MFAEnrollRequest {
  reserved 4 to 10;

  // MFA type to enroll
  MultiFactorType mfa_type = 1;

  // User ID (defaults to authenticated user)
  string user_id = 2;

  // Device context
  geniustechspace.datastructure.v1.device.DeviceContext device = 3;

  // Client context
  geniustechspace.datastructure.v1.client.ClientContext client = 4;

  // Tenant ID
  string tenant_id = 11;
}

message MFAEnrollResponse {
  reserved 5 to 10;

  // Enrollment ID
  string enrollment_id = 1;

  // Secret/QR code for TOTP
  string secret = 2;

  // QR code image (base64)
  string qr_code = 3;

  // Backup codes
  repeated string backup_codes = 4;

  // User-facing message
  string message = 11;
}

message MFAVerifyEnrollmentRequest {
  reserved 4 to 10;

  // Enrollment ID
  string enrollment_id = 1;

  // Verification code
  string code = 2;

  // User ID
  string user_id = 3;

  // Tenant ID
  string tenant_id = 11;
}

message MFAVerifyEnrollmentResponse {
  reserved 3 to 10;

  // Success flag
  bool success = 1;

  // MFA method info
  MFAMethodInfo method_info = 2;

  // User-facing message
  string message = 11;
}

message MFAVerifyRequest {
  reserved 4 to 10;

  // Challenge ID
  string challenge_id = 1;

  // MFA proof
  AuthProof proof = 2;

  // User ID
  string user_id = 3;

  // Tenant ID
  string tenant_id = 11;
}

message MFAVerifyResponse {
  reserved 3 to 10;

  // Success flag
  bool success = 1;

  // Session token (if final step)
  TokenSet tokens = 2;

  // User-facing message
  string message = 11;
}

message MFAListRequest {
  reserved 2 to 10;

  // User ID (defaults to authenticated user)
  string user_id = 1;

  // Tenant ID
  string tenant_id = 11;
}

message MFAListResponse {
  reserved 2 to 10;

  // MFA methods
  repeated MFAMethodInfo methods = 1;

  // Total count
  int32 total_count = 11;
}

message MFAMethodInfo {
  reserved 7 to 30;

  // Method ID
  string method_id = 1;

  // MFA type
  MultiFactorType mfa_type = 2;

  // Display name
  string name = 3;

  // Created timestamp
  google.protobuf.Timestamp created_at = 4;

  // Last used timestamp
  google.protobuf.Timestamp last_used_at = 5;

  // Active status
  bool active = 6;

  // Device context (if applicable)
  geniustechspace.datastructure.v1.device.DeviceContext device = 31;

  // Client context (if applicable)
  geniustechspace.datastructure.v1.client.ClientContext client = 32;
}

message MFADisableRequest {
  reserved 3 to 10;

  // Method ID
  string method_id = 1;

  // User ID (defaults to authenticated user)
  string user_id = 2;

  // Tenant ID
  string tenant_id = 11;
}

message MFADisableResponse {
  reserved 2 to 10;

  // Success flag
  bool success = 1;

  // User-facing message
  string message = 11;
}

message BackupCodesGenerateRequest {
  reserved 3 to 10;

  // User ID (defaults to authenticated user)
  string user_id = 1;

  // Number of codes (default 10)
  int32 count = 2;

  // Tenant ID
  string tenant_id = 11;
}

message BackupCodesGenerateResponse {
  reserved 3 to 10;

  // Backup codes
  repeated string codes = 1;

  // Generated timestamp
  google.protobuf.Timestamp generated_at = 2;

  // User-facing message
  string message = 11;
}

message BackupCodesStatusRequest {
  reserved 2 to 10;

  // User ID (defaults to authenticated user)
  string user_id = 1;

  // Tenant ID
  string tenant_id = 11;
}

message BackupCodesStatusResponse {
  reserved 3 to 10;

  // Remaining codes count
  int32 remaining_count = 1;

  // Total codes generated
  int32 total_count = 2;

  // User-facing message
  string message = 11;
}

// OAuth2 messages
message OAuth2AuthorizeRequest {
  reserved 8 to 30;

  // Client ID
  string client_id = 1;

  // Response type (code, token)
  string response_type = 2;

  // Redirect URI
  string redirect_uri = 3;

  // Requested scopes
  repeated string scopes = 4;

  // State parameter
  string state = 5;

  // Code challenge (PKCE)
  string code_challenge = 6;

  // Code challenge method (S256)
  string code_challenge_method = 7;

  // Tenant ID
  string tenant_id = 31;
}

message OAuth2AuthorizeResponse {
  reserved 4 to 30;

  // Authorization code
  string code = 1;

  // State parameter
  string state = 2;

  // Redirect URI with params
  string redirect_uri = 3;
}

message OAuth2TokenRequest {
  reserved 8 to 30;

  // Grant type
  OAuth2GrantType grant_type = 1;

  // Authorization code (for authorization_code grant)
  string code = 2;

  // Redirect URI
  string redirect_uri = 3;

  // Client ID
  string client_id = 4;

  // Client secret
  string client_secret = 5;

  // Refresh token (for refresh_token grant)
  string refresh_token = 6;

  // Code verifier (PKCE)
  string code_verifier = 7;

  // Tenant ID
  string tenant_id = 31;
}

message OAuth2TokenResponse {
  reserved 2 to 30;

  // Token set
  TokenSet tokens = 1;
}

message OAuth2DeviceAuthorizationRequest {
  reserved 3 to 30;

  // Client ID
  string client_id = 1;

  // Requested scopes
  repeated string scopes = 2;

  // Tenant ID
  string tenant_id = 31;
}

message OAuth2DeviceAuthorizationResponse {
  reserved 6 to 30;

  // Device code
  string device_code = 1;

  // User code
  string user_code = 2;

  // Verification URI
  string verification_uri = 3;

  // Verification URI complete
  string verification_uri_complete = 4;

  // Expiration in seconds
  int64 expires_in = 5;

  // Polling interval
  int32 interval = 31;
}

message OAuth2UserInfoRequest {
  reserved 2 to 30;

  // Access token
  string access_token = 1;
}

message OAuth2UserInfoResponse {
  reserved 10 to 30;

  // Subject (user ID)
  string sub = 1;

  // Name
  string name = 2;

  // Email
  string email = 3;

  // Email verified
  bool email_verified = 4;

  // Preferred username
  string preferred_username = 5;

  // Picture URL
  string picture = 6;

  // Phone number
  string phone_number = 7;

  // Phone verified
  bool phone_number_verified = 8;

  // Custom claims
  map<string, string> claims = 9;
}

message OAuth2ClientRegisterRequest {
  reserved 7 to 30;

  // Client name
  string client_name = 1;

  // Redirect URIs
  repeated string redirect_uris = 2;

  // Grant types
  repeated OAuth2GrantType grant_types = 3;

  // Response types
  repeated string response_types = 4;

  // Scopes
  repeated string scopes = 5;

  // Application type (web, native, spa)
  string application_type = 6;

  // Tenant ID
  string tenant_id = 31;
}

message OAuth2ClientRegisterResponse {
  reserved 2 to 30;

  // Client info
  OAuth2ClientInfo client_info = 1;
}

message OAuth2ClientInfo {
  reserved 10 to 30;

  // Client ID
  string client_id = 1;

  // Client secret
  string client_secret = 2;

  // Client name
  string client_name = 3;

  // Redirect URIs
  repeated string redirect_uris = 4;

  // Grant types
  repeated OAuth2GrantType grant_types = 5;

  // Response types
  repeated string response_types = 6;

  // Scopes
  repeated string scopes = 7;

  // Application type
  string application_type = 8;

  // Created timestamp
  google.protobuf.Timestamp created_at = 9;

  // Tenant ID
  string tenant_id = 31;
}

message OAuth2ClientGetRequest {
  reserved 2 to 30;

  // Client ID
  string client_id = 1;

  // Tenant ID
  string tenant_id = 31;
}

message OAuth2ClientUpdateRequest {
  reserved 6 to 30;

  // Client ID
  string client_id = 1;

  // Client name
  string client_name = 2;

  // Redirect URIs
  repeated string redirect_uris = 3;

  // Grant types
  repeated OAuth2GrantType grant_types = 4;

  // Scopes
  repeated string scopes = 5;

  // Tenant ID
  string tenant_id = 31;
}

message OAuth2ClientDeleteRequest {
  reserved 2 to 30;

  // Client ID
  string client_id = 1;

  // Tenant ID
  string tenant_id = 31;
}

// Social login messages
message SocialLoginAuthUrlRequest {
  reserved 4 to 30;

  // Provider
  SocialProvider provider = 1;

  // Redirect URI
  string redirect_uri = 2;

  // State parameter
  string state = 3;

  // Tenant ID
  string tenant_id = 31;
}

message SocialLoginAuthUrlResponse {
  reserved 3 to 30;

  // Authorization URL
  string authorization_url = 1;

  // State parameter
  string state = 2;
}

message SocialLoginAuthenticateRequest {
  reserved 4 to 30;

  // Provider
  SocialProvider provider = 1;

  // Authorization code
  string code = 2;

  // State parameter
  string state = 3;

  // Tenant ID
  string tenant_id = 31;
}

message SocialLinkAccountRequest {
  reserved 5 to 30;

  // Provider
  SocialProvider provider = 1;

  // Authorization code
  string code = 2;

  // User ID (defaults to authenticated user)
  string user_id = 3;

  // State parameter
  string state = 4;

  // Tenant ID
  string tenant_id = 31;
}

message SocialLinkAccountResponse {
  reserved 3 to 30;

  // Success flag
  bool success = 1;

  // Linked account info
  SocialAccountInfo account_info = 2;

  // User-facing message
  string message = 11;
}

message SocialUnlinkAccountRequest {
  reserved 4 to 30;

  // Provider
  SocialProvider provider = 1;

  // Provider user ID
  string provider_user_id = 2;

  // User ID (defaults to authenticated user)
  string user_id = 3;

  // Tenant ID
  string tenant_id = 31;
}

message SocialUnlinkAccountResponse {
  reserved 2 to 30;

  // Success flag
  bool success = 1;

  // User-facing message
  string message = 11;
}

message SocialListAccountsRequest {
  reserved 2 to 30;

  // User ID (defaults to authenticated user)
  string user_id = 1;

  // Tenant ID
  string tenant_id = 31;
}

message SocialListAccountsResponse {
  reserved 2 to 30;

  // Linked accounts
  repeated SocialAccountInfo accounts = 1;

  // Total count
  int32 total_count = 11;
}

message SocialAccountInfo {
  reserved 6 to 30;

  // Provider
  SocialProvider provider = 1;

  // Provider user ID
  string provider_user_id = 2;

  // Provider email
  string provider_email = 3;

  // Provider display name
  string provider_display_name = 4;

  // Linked timestamp
  google.protobuf.Timestamp linked_at = 5;

  // Last used timestamp
  google.protobuf.Timestamp last_used_at = 31;
}

// SAML messages
message SAMLInitiateSSORequest {
  reserved 3 to 30;

  // IDP entity ID
  string idp_entity_id = 1;

  // Relay state
  string relay_state = 2;

  // Tenant ID
  string tenant_id = 31;
}

message SAMLInitiateSSOResponse {
  reserved 3 to 30;

  // SAML request XML
  string saml_request = 1;

  // IDP SSO URL
  string sso_url = 2;

  // Relay state
  string relay_state = 31;
}

message SAMLProcessAssertionRequest {
  reserved 4 to 30;

  // SAML response (base64)
  string saml_response = 1;

  // Relay state
  string relay_state = 2;

  // Binding type
  SAMLBindingType binding = 3;

  // Tenant ID
  string tenant_id = 31;
}

message SAMLGetMetadataRequest {
  reserved 2 to 30;

  // Tenant ID
  string tenant_id = 1;
}

message SAMLMetadataResponse {
  reserved 2 to 30;

  // Metadata XML
  string metadata_xml = 1;
}

message SAMLInitiateSLORequest {
  reserved 3 to 30;

  // Session index
  string session_index = 1;

  // Name ID
  string name_id = 2;

  // Tenant ID
  string tenant_id = 31;
}

message SAMLInitiateSLOResponse {
  reserved 3 to 30;

  // Logout request XML
  string logout_request = 1;

  // IDP SLO URL
  string slo_url = 2;

  // Relay state
  string relay_state = 31;
}

message SAMLProcessSLORequest {
  reserved 3 to 30;

  // Logout response (base64)
  string logout_response = 1;

  // Relay state
  string relay_state = 2;

  // Tenant ID
  string tenant_id = 31;
}

message SAMLProcessSLOResponse {
  reserved 2 to 30;

  // Success flag
  bool success = 1;

  // User-facing message
  string message = 11;
}
