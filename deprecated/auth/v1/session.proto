// Session Management Messages - Version 1
//
// Session listing, revocation, and lifecycle management for authenticated users.
// Enables users to view and manage their active authentication sessions.
//
// COMPLIANCE: SOC 2 CC6.1 (Session Management), GDPR (User Control)
// SECURITY: Session operations require authentication and authorization

syntax = "proto3";

package auth.v1;

import "proto/datastructure/v1/session/messages.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Auth.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/auth/v1;authv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.auth.v1";

// ============================================================================
// SESSION LISTING
// ============================================================================

// SessionListRequest requests user's active sessions
message SessionListRequest {
  reserved 3 to 10;

  // User ID (defaults to authenticated user)
  string user_id = 1;

  // Include expired sessions
  bool include_expired = 2;

  // Tenant ID
  string tenant_id = 11;
}

// SessionListResponse returns list of sessions
message SessionListResponse {
  reserved 2 to 10;

  // List of sessions
  repeated geniustechspace.datastructure.v1.session.Session sessions = 1;

  // Total count
  int32 total_count = 11;
}

// ============================================================================
// SESSION REVOCATION
// ============================================================================

// SessionRevokeRequest revokes specific session
message SessionRevokeRequest {
  reserved 3 to 10;

  // Session ID to revoke
  string session_id = 1;

  // User ID (defaults to authenticated user)
  string user_id = 2;

  // Tenant ID
  string tenant_id = 11;
}

// SessionRevokeResponse confirms session revocation
message SessionRevokeResponse {
  reserved 2 to 10;

  // Success flag
  bool success = 1;

  // User-facing message
  string message = 11;
}

// SessionRevokeAllRequest revokes all sessions for a user
message SessionRevokeAllRequest {
  reserved 3 to 10;

  // User ID (defaults to authenticated user)
  string user_id = 1;

  // Exclude current session
  bool exclude_current = 2;

  // Tenant ID
  string tenant_id = 11;
}

// SessionRevokeAllResponse confirms all sessions revoked
message SessionRevokeAllResponse {
  reserved 2 to 10;

  // Number of sessions revoked
  int32 revoked_count = 1;

  // User-facing message
  string message = 11;
}
