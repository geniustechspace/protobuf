// Authentication Flow Messages - Version 1
//
// Core authentication request/response messages for enterprise IDP operations.
// Handles multi-step authentication flows, challenge-response, and MFA.
//
// COMPLIANCE: SOC 2 CC6.1 (Access Controls), NIST 800-63B (Authentication)
// SECURITY: Contains sensitive authentication data - encrypt in transit (TLS)

syntax = "proto3";

package auth.v1;

import "proto/datastructure/v1/session/messages.proto";
import "proto/datastructure/v1/auth/messages.proto";
import "auth/v1/enums.proto";
import "auth/v1/proofs.proto";
import "auth/v1/tokens.proto";

option csharp_namespace = "GeniusTechSpace.Protobuf.Auth.V1";
option go_package = "github.com/geniustechspace/protobuf/gen/go/auth/v1;authv1";
option java_multiple_files = true;
option java_package = "com.geniustechspace.protobuf.auth.v1";

// AuthenticationRequest initiates or continues a multi-step authentication flow
message AuthenticationRequest {
  reserved 6 to 10, 18 to 30;

  // Authentication flow ID for multi-step flows (generated by server on first request)
  string auth_id = 1;

  // User identifier - at least one must be provided
  oneof identifier {
    string user_id = 2;
    string username = 3;
    string email = 4;
    string phone = 5;
  }

  // Authentication proof (see proofs.proto)
  AuthProof proof = 11;

  // Tenant ID for multi-tenant environments
  string tenant_id = 31;

  // Session preferences
  bool remember_session = 32;
}

// AuthenticationResponse returns authentication flow status and next steps
message AuthenticationResponse {
  reserved 5 to 10, 18 to 30;

  // Authentication flow ID
  string auth_id = 1;

  // Current authentication status
  AuthenticationStatus status = 2;

  // User ID (populated on successful authentication)
  string user_id = 3;

  // Tenant ID
  string tenant_id = 4;

  // Required authentication methods (if MFA or additional steps needed)
  repeated AuthenticationMethod required_methods = 11;

  // Challenge data (WebAuthn, OTP seed, etc.)
  geniustechspace.datastructure.v1.auth.ChallengeData challenge = 12;

  // Tokens (if authentication completed successfully)
  TokenSet tokens = 13;

  // Session information
  geniustechspace.datastructure.v1.session.Session session = 14;

  // Risk assessment
  geniustechspace.datastructure.v1.auth.RiskAssessment risk = 15;

  // User-facing message
  string message = 16;

  // Message localization key
  string message_key = 17;
}
